requirejs.config({baseUrl:"./js",paths:{jquery:"libs/jquery-2.0.2",three:"libs/three"}});define(["jquery","three"],function(){function e(e){var i=e.system.stage;var s=new THREE.Object3D;i.add(s);var d=e.system.camera;var l=e.system.nodeIdDict;var u=e.system.pointsSystemDict;var f=e.system.topo_node_line;var v=e.system.container;var c=e.system.controlsContainer;var p=e.system.TWEEN;var h=b();var m=e.texturesRoot;var g=e.textureslibs;var y={};var E=[];var w=[];var T=[];function b(){var e={loadPicture:function(e){return(new THREE.TextureLoader).load(m+e)},loadWord:function(e){var t=new THREE.Texture(e);t.needsUpdate=true;return t}};return e}var C={protectedEffect:{vertexShader:["varying vec3 vposition;","varying float opacity;","void main(){","\tvec3 vposition = position;","\tvec2 normalizePos = normalize(vposition.xz);","\tfloat angle;","\tif(normalizePos.y > 0.0){","\t\tif(normalizePos.x == 0.0){","\t\t\tangle = radians(90.0);","\t\t} else {","\t\t\tangle = acos(normalizePos.x);","\t\t}","\t} else if(normalizePos.y < 0.0){","\t\tif(normalizePos.x != 0.0){","\t\t\tangle = radians(360.0) - acos(normalizePos.x);","\t\t} else {","\t\t\tangle = radians(270.0);","\t\t}","\t} else if(normalizePos.y == 0.0){","\t\tif(normalizePos.x > 0.0){","\t\t\tangle = radians(0.0);","\t\t} else if(normalizePos.x < 0.0){","\t\t\tangle = radians(180.0);","\t\t}","\t}","\topacity = pow(abs(cos(angle * 2.0 / 2.0)),8.0);","\tgl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","}"].join("\n"),fragmentShader:["uniform vec3 topColor;","uniform vec3 bottomColor;","uniform float offset;","uniform float exponent;","varying vec3 vposition;","varying float opacity;","void main(){","\tfloat h = normalize(vposition + offset).x;","\tgl_FragColor = vec4( mix( bottomColor, topColor, max( pow( max( h , 0.0), exponent ), 0.0 ) ),  opacity);","}"].join("\n")},shotEffectA:{vertexShader:["attribute float customSize;","attribute float customOpacity;","attribute float order;","uniform float offsetT;","uniform float distance;","uniform float plength;","uniform vec3 len_pos;","varying float opa;","void main(){","\topa = customOpacity;","\tfloat distanceFactor = (distance + plength * 3.0) * offsetT;","\tfloat key_pos = distanceFactor - order * 3.0;","\tfloat key_factor = key_pos / distance;","\tvec3 newPosition = position + key_factor * len_pos;","\tvec4 mvPosition = modelViewMatrix * vec4(newPosition ,1.0);","\tgl_PointSize = customSize * 300.0 / length(mvPosition.xyz);","\tif(key_pos >= 0.0 && key_pos <= distance){","\t\topa = 1.0 - (order / (plength - 1.0));","\t} else {","\t\topa = 0.0;","\t}","\tgl_Position = projectionMatrix * mvPosition;","}"].join("\n"),fragmentShader:["uniform vec3 color;","uniform float opacity;","uniform sampler2D texture;","varying float opa;","void main(){","\tvec4 outColor = texture2D(texture,vec2(gl_PointCoord.x,1.0 - gl_PointCoord.y));","\tif(outColor.a < 0.1) discard;","\tgl_FragColor = vec4(outColor.rgb * color,opacity * outColor.a * opa);","}"].join("\n")}};var R={lineEvent:{tubeLine:L,particlesLine:z,shotLineA:x,transfer:M,stateLineA:S},nodeEvent:{setSize:A,setColor:U,setOpacity:P,zoom:O,flash:I,flicker:D,protection:_,stateA:G,stateB:k,stateC:F,wireframe:H,similarGif:j}};return R;function H(e){var e=e!==undefined?e:{};var t=e.radius!==undefined?e.radius:60;var r=e.segment!==undefined?e.segment:6;if(r<3)r=3;var n=new THREE.Shape;var a=u(t,r);for(var o=0;o<=r;o++){if(o==0){n.moveTo(a[o][0],a[o][1])}else{n.lineTo(a[o][0],a[o][1])}}var i=e.color!==undefined?e.color:16776960;var s=n.createPointsGeometry();var d=new THREE.LineDashedMaterial({color:i,transparent:true});var l=new THREE.Line(s,d);l.rotation.x=-Math.PI/2;return l;function u(e,t){var r=e;var n=t;var a=Math.PI/180;var o=[];var i=360/t;for(var s=0;s<=t;s++){var d=r*Math.cos(i*a*s);var l=r*Math.sin(i*a*s);o.push([d,l])}return o}}function S(e,t,r){var n=e!==undefined?e:undefined;if(e===undefined){return console.warn("stateLineEffectA is not found nodeIdList")}if(!(e instanceof Array)||e.length!=2){return console.warn("stateLineEffectA have an error nodeIdList")}var r=r!==undefined?r:undefined;var t=t!==undefined?t:{};var a=t.width!==undefined?t.width:30;var o=t.color!==undefined?t.color:"rgba(92,34,140,0.5)";var i=new THREE.MeshBasicMaterial({map:m(o),alphaMap:g(),blending:THREE.AdditiveBlending,transparent:true,side:THREE.DoubleSide,depthWrite:false,depthTest:false});var s=e[0];var d=e[1];var u=l[s].clone();var f=l[d].clone();var v=u.distanceTo(f);var c=new THREE.Mesh(new THREE.PlaneGeometry(v,a),i);c.position.x=(u.x+f.x)/2;c.position.y=(u.y+f.y)/2;c.position.z=(u.z+f.z)/2;c.rotateZ(Math.atan((f.y-u.y)/(f.x-u.x)));if(f.x-u.x<0)c.rotateY(Math.asin((f.z-u.z)/v));else c.rotateY(-Math.asin((f.z-u.z)/v));var p=c.clone();p.rotateX(Math.PI/2);var h=new THREE.Object3D;h.add(c);h.add(p);return h;function m(e){var t=document.createElement("canvas");t.height=64;t.width=64;var r=t.getContext("2d");var n=r.createLinearGradient(0,0,0,t.width);n.addColorStop(0,"rgba(0, 0, 0, 0)");n.addColorStop(.45,e);n.addColorStop(.5,"rgba(255, 255, 255, 0.5)");n.addColorStop(.55,e);n.addColorStop(1,"rgba(0, 0, 0, 0)");r.fillStyle=n;r.fillRect(0,0,t.width,t.height);var a=new THREE.Texture(t);a.needsUpdate=true;return a}function g(){var e=document.createElement("canvas");e.height=64;e.width=64;var t=e.getContext("2d");var r=t.createLinearGradient(0,0,e.width,0);r.addColorStop(0,"#000000");r.addColorStop(.3,"#ffffff");r.addColorStop(.7,"#ffffff");r.addColorStop(1,"#000000");t.fillStyle=r;t.fillRect(0,0,e.width,e.height);var n=new THREE.Texture(e);n.needsUpdate=true;return n}}function x(e,t,r){if(!(e instanceof Array)||e.length<2){return console.warn("shotLineAEffect have an error nodeIdList")}var t=t!==undefined?t:{};var n=t.map!==undefined?t.map:undefined;var a=t.parentobj!==undefined?t.parentobj:s;if(n===undefined){return console.warn("shotLineAEffect is not found map")}if(typeof n=="string"){var o=h.loadPicture(g[n])}else{var o=n}var i=C["shotEffectA"];var d=t.color!==undefined?t.color:16777215;var u=t.size!==undefined?t.size:100;var f=Math.floor(u/3*2);var v=t.length!==undefined?t.length:100;var c=t.speed!==undefined?t.speed:5;var m=t.repeat!==undefined?t.repeat:Infinity;var y=t.delay!==undefined?t.delay:0;if(m>=100){m=Infinity}var r=r!==undefined?r:undefined;var w=2001;if(v>2e3){v=2e3}var T=[];var b=e[0];var R=e[1];S(b,R);var H={};H.tweens=[];H.remove=function(){while(T.length>0){var e=T.shift();a.remove(e);E.push(e)}while(H.tweens.length>0){p.remove(H.tweens.shift())}};return H;function S(t,n){if(E.length==0){var s=new THREE.BufferGeometry;var h=new Float32Array(w*3);var g=new Float32Array(w);var b=new Float32Array(w);var C=new Float32Array(w);var R=l[t].clone();var x=l[n].clone();for(var z=0;z<w;z++){if(z<v){R.toArray(h,z*3);g[z]=1;b[z]=u-f*z/(v-1);C[z]=z}else{x.toArray(h,z*3);g[z]=0;b[z]=0;C[z]=z}}s.addAttribute("position",new THREE.BufferAttribute(h,3).setDynamic(true));s.addAttribute("customOpacity",new THREE.BufferAttribute(g,1).setDynamic(true));s.addAttribute("customSize",new THREE.BufferAttribute(b,1).setDynamic(true));s.addAttribute("order",new THREE.BufferAttribute(C,1).setDynamic(true));s.setDrawRange(0,v);var M=new THREE.Points(s,new THREE.ShaderMaterial({fragmentShader:i.fragmentShader,vertexShader:i.vertexShader,uniforms:{color:{type:"c",value:new THREE.Color(d)},opacity:{type:"f",value:1},texture:{type:"t",value:o},offsetT:{type:"f",value:0},distance:{type:"f",value:0},plength:{type:"f",value:v},len_pos:{type:"v3",value:new THREE.Vector3}},transparent:true,blending:THREE.AdditiveBlending,depthTest:false}));T.push(M)}else{var M=E.shift();T.push(M);M.material.uniforms.texture.value=o;var s=M.geometry;s.setDrawRange(0,v);var R=l[t].clone();var x=l[n].clone();for(var z=0;z<w;z++){if(z<v){s.attributes.position.array[z*3]=R.x;s.attributes.position.array[z*3+1]=R.y;s.attributes.position.array[z*3+2]=R.z;s.attributes.customOpacity.array[z]=1;s.attributes.customSize.array[z]=u-f*z/(v-1)}else{s.attributes.position.array[z*3]=x.x;s.attributes.position.array[z*3+1]=x.y;s.attributes.position.array[z*3+2]=x.z;s.attributes.customOpacity.array[z]=0;s.attributes.customSize.array[z]=0}}s.attributes.position.needsUpdate=true;s.attributes.customOpacity.needsUpdate=true;s.attributes.customSize.needsUpdate=true}var L=(new THREE.Vector3).copy(l[t]);var P=(new THREE.Vector3).copy(l[n]);var A=(new THREE.Vector3).subVectors(P,L);var U=A.length();var O=Math.floor(U);M.material.uniforms.distance.value=O;M.material.uniforms.len_pos.value=A;var I=Math.floor(O/c)*20;var D=new p.Tween({t:0}).to({t:1},I).delay(y).easing(p.Easing.Linear.None).onStart(function(){a.add(M);H.tweens.push(D)}).onUpdate(function(){M.material.uniforms.offsetT.value=this.t}).onComplete(function(){e.shift();if(e[1]){S(e[0],e[1])}else{r&&(r instanceof Function&&r())}var t=H.tweens.indexOf(D);if(t!==-1){H.tweens.splice(t,1)}if(m==0){a.remove(M);E.push(M);var n=T.indexOf(M);T.splice(n,1);console.info(E)}}).start();if(m!==0){var j=new p.Tween({t:0}).to({t:1},I).easing(p.Easing.Linear.None).repeat(m).onUpdate(function(){M.material.uniforms.offsetT.value=this.t}).onComplete(function(){var e=H.tweens.indexOf(j);if(e!==-1){H.tweens.splice(e,1)}a.remove(M);E.push(M);var t=T.indexOf(M);T.splice(t,1)});D.chain(j);M.tween=j}}}function z(e,t,r){var t=t!==undefined?t:{};var n=t.speed!==undefined?t.speed:3;var a=t.size!==undefined?t.size:50;var o=t.segmentDistance!==undefined?t.segmentDistance:80;var i=t.during!==undefined?t.during:-1;var d=t.material!==undefined?t.material:undefined;var i=t.during!==undefined?t.during:-1;var u=t.parentobj!==undefined?t.parentobj:s;var f=0;for(var v=0;v<e.length-1;v++){f+=l[e[v]].distanceTo(l[e[v+1]])}var c=[];c[0]=0;for(var h=0;h<e.length-1;h++){c[h+1]=c[h]+l[e[h]].distanceTo(l[e[h+1]])/f}var m=Math.ceil(f/n)*10;var g=m*(c[1]-c[0]);if(i>0){g=i}var y=[];var E={};E.tweens=[];w(e[0],e[1],g);E.remove=function(){while(y.length>0){var e=y.shift();u.remove(e);T.push(e)}};return E;function w(t,n,s){var f=l[t].clone();var v=l[n].clone();var s=Math.floor(s);var h=f.distanceTo(v);var b=Math.ceil(h/o);var C=1/b;var R=new THREE.LineCurve3(f,v);var H=[];for(var S=0;S<b;S++){if(T.length==0){var x=new THREE.Sprite(d);x.scale.set(a,a,1);x.position.set(f.x,f.y,f.z);u.add(x);y.push(x);H.push(x)}else{var x=T[0];T.splice(0,1);x.material=d;x.scale.set(a,a,1);x.position.set(f.x,f.y,f.z);u.add(x);y.push(x);H.push(x)}}var z=new p.Tween({percent:0}).to({percent:1},g).easing(p.Easing.Linear.None).onStart(function(){}).onUpdate(function(){for(var e=0,t=H.length;e<t;e++){var r=this.percent-e*C;if(r>=0){var n=R.getPointAt(r);H[e].position.set(n.x,n.y,n.z)}}}).onComplete(function(){e.shift();c.shift();var t=m*(c[1]-c[0]);if(i>0){t=i}if(e[1]){w(e[0],e[1],t)}else{r&&(r instanceof Function&&r())}}).start();E.tweens.push(z);var M=new p.Tween({percent:0}).to({percent:1},s).easing(p.Easing.Linear.None).repeat(30).onUpdate(function(){for(var e=0,t=H.length;e<t;e++){var r=this.percent-e*C;r=r<0?1+r:r;var n=R.getPointAt(r);H[e].position.set(n.x,n.y,n.z)}});z.chain(M);E.tweens.push(M)}}function M(e,t,r){if(!(e instanceof Array)||e.length<2){return console.warn("fileRunEvent have an error nodeIdList")}var r=r!==undefined?r:undefined;var t=t!==undefined?t:{};var n=t.material!==undefined?t.material:null;var a=t.speed!==undefined?t.speed:1;var o=t.scale!==undefined?t.scale:100;var i=t.parentobj!==undefined?t.parentobj:s;if(n==null){return}else{var d=0;var u=[];for(var f=0;f<e.length-1;f++){d+=l[e[f]].distanceTo(l[e[f+1]])}var v=[];v[0]=0;for(var c=0;c<e.length-1;c++){v[c+1]=v[c]+l[e[c]].distanceTo(l[e[c+1]])/d}var h=Math.ceil(d/a)*10;var m=h*(v[1]-v[0]);var g={};g.tweens=[];y(e[0],e[1],m);g.remove=function(){while(u.length>0){var e=u.shift();i.remove(e);w.push(e)}};return g;function y(t,a,s){var d=l[t].clone();var f=l[a].clone();var s=Math.floor(s);var c=new THREE.LineCurve3(d,f);if(w.length==0){var m=new THREE.Sprite(n);m.scale.set(o,o,1)}else{var m=w[0];w.splice(0,1);m.scale.set(o,o,1);m.material=n}m.position.copy(d);var E=new p.Tween({percent:0}).to({percent:1},s).easing(p.Easing.Linear.None).onStart(function(){i.add(m);u.push(m)}).onUpdate(function(){m.position.copy(c.getPoint(this.percent))}).onComplete(function(){e.shift();v.shift();i.remove(m);w.push(m);if(e[1]){var t=h*(v[1]-v[0]);y(e[0],e[1],t)}else{r&&(r instanceof Function&&r())}var n=g.tweens.indexOf(E);var a=u.indexOf(m);u.splice(a,1)}).start();g.tweens.push(E)}}}function L(e,t,r){if(!(e instanceof Array)){return console.warn("tubeLineEffect have an error nodeIdList")}var t=t!==undefined?t:{};if(t.material==undefined){return console.warn("material must be defined")}var n=t.material;var r=r!==undefined?r:undefined;var a=t.speed!==undefined?t.speed:1;var o=t.radius!==undefined?t.radius:3;var i=t.radialSegment!==undefined?t.radialSegment:3;var d=t.parentobj!==undefined?t.parentobj:s;var u=0;var f=[];for(var v=0;v<e.length-1;v++){u+=l[e[v]].distanceTo(l[e[v+1]])}var c=[];c[0]=0;for(var h=0;h<e.length-1;h++){c[h+1]=c[h]+l[e[h]].distanceTo(l[e[h+1]])/u}var m=Math.ceil(u/a)*10;var g=m*(c[1]-c[0]);var E={};E.tweens=[];w(e[0],e[1],g);E.remove=function(){while(f.length>0){var e=f.shift();d.remove(e);e.geometry.dispose()}};return E;function w(t,a,s){var u=l[t].clone();var v=l[a].clone();var s=Math.floor(s);var h=new THREE.LineCurve3(u,v);if(y[i]==undefined||y[i].length==0){var g=new THREE.TubeGeometry(h,1,o,i,false);var T=new THREE.Mesh(g,n);f.push(T);for(var b=0,C=g.vertices.length/2;b<C;b++){g.vertices[b+C].posx=g.vertices[b+C].x;g.vertices[b+C].posy=g.vertices[b+C].y;g.vertices[b+C].posz=g.vertices[b+C].z;g.vertices[b+C].x=g.vertices[b].x;g.vertices[b+C].y=g.vertices[b].y;g.vertices[b+C].z=g.vertices[b].z}}else{var T=y[i][0];y[i].splice(0,1);T.material=n;f.push(T);var g=T.geometry;var R=new THREE.TubeGeometry.FrenetFrames(h,1,false);var H=R.normals[0];var S=R.binormals[0];var x=R.normals[1];var z=R.binormals[1];var M=new THREE.Vector3;var L=new THREE.Vector3;for(var b=0,C=g.vertices.length/2;b<C;b++){var P=b/i*Math.PI*2;var A=Math.sin(P);var U=-Math.cos(P);M.x=U*H.x+A*S.x;M.y=U*H.y+A*S.y;M.z=U*H.z+A*S.z;M.normalize();L.x=U*x.x+A*z.x;L.y=U*x.y+A*z.y;L.z=U*x.z+A*z.z;g.vertices[b+C].posx=v.x+o*L.x;g.vertices[b+C].posy=v.y+o*L.y;g.vertices[b+C].posz=v.z+o*L.z;g.vertices[b+C].x=u.x+o*M.x;g.vertices[b+C].y=u.y+o*M.y;g.vertices[b+C].z=u.z+o*M.z;g.vertices[b].x=u.x+o*M.x;g.vertices[b].y=u.y+o*M.y;g.vertices[b].z=u.z+o*M.z}}var O=new p.Tween({percent:0}).to({percent:1},s).easing(p.Easing.Linear.None).onStart(function(){d.add(T)}).onUpdate(function(){for(b=0,C=g.vertices.length/2;b<C;b++){g.vertices[b+C].x=g.vertices[b].x+(g.vertices[b+C].posx-g.vertices[b].x)*this.percent;g.vertices[b+C].y=g.vertices[b].y+(g.vertices[b+C].posy-g.vertices[b].y)*this.percent;g.vertices[b+C].z=g.vertices[b].z+(g.vertices[b+C].posz-g.vertices[b].z)*this.percent}g.verticesNeedUpdate=true;g.computeBoundingSphere()}).onComplete(function(){e.shift();c.shift();if(e[1]){var t=m*(c[1]-c[0]);w(e[0],e[1],t)}else{r&&(r instanceof Function&&r())}}).start();E.tweens.push(O)}}function P(e,t){var e=e!==undefined?e:undefined;if(e===undefined)return;var t=t!==undefined?t:{};var r=t.opacity!==undefined?t.opacity:1;var n,a,o;for(var i=0;i<e.length;i++){a=e[i];if(l[a]!=undefined){n=u[l[a].topoType];o=l[a].index;n.geometry.attributes.customOpacity.array[o]=r;n.geometry.attributes.customOpacity.needsUpdate=true}}}function A(e,t){var e=e!==undefined?e:undefined;if(e===undefined)return;var t=t!==undefined?t:{};var r=t.size!==undefined?t.size:1;var n,a,o;for(var i=0;i<e.length;i++){a=e[i];if(l[a]!=undefined){n=u[l[a].topoType];o=l[a].index;n.geometry.attributes.customSize.array[o]=r;n.geometry.attributes.customSize.needsUpdate=true}}}function U(e,t){var e=e!==undefined?e:undefined;if(e===undefined){return console.warn("flickerEffect is not found nodeIdList")}if(!(e instanceof Array)){e=[e]}var t=t!==undefined?t:{};var r=t.color!==undefined?t.color:16711680;var n=new THREE.Color(r);var a=n.r,o=n.g,i=n.b;for(var s=0;s<e.length;s++){var d=e[s];var f=u[l[d].topoType];var v=l[d].index;f.geometry.attributes.customColor.array[v*3]=a;f.geometry.attributes.customColor.array[v*3+1]=o;f.geometry.attributes.customColor.array[v*3+2]=i;f.geometry.attributes.customColor.needsUpdate=true}}function O(e,t){var e=e!==undefined?e:undefined;if(e===undefined){return console.warn("zoomEffect is not found nodeId")}var t=t!==undefined?t:{};var r=t.size!==undefined?t.size:0;var n=t.repeat!==undefined?t.repeat:1;var a=t.during!==undefined?t.during:500;if(e==="node_all"){for(var o in u){if(o!=="line"){u[o].material.uniforms.size.value=r}}}else{for(var i=0;i<f.children.length;i++){if(f.children[i]instanceof THREE.Points){if(f.children[i].topoType==l[e].topoType){var s=f.children[i];for(var d=0,v=s.geometry.idsList.length;d<v;d++){if(s.geometry.idsList[d]==e){var c=d;var h=s.geometry.attributes.customSize.array[c];if(n>100){new p.Tween({op:h}).to({op:r},a).easing(p.Easing.Linear.None).onUpdate(function(){s.geometry.attributes.customSize.array[c]=this.op;s.geometry.attributes.customSize.needsUpdate=true}).repeat(Infinity).yoyo(true).onComplete(function(){}).start()}else{new p.Tween({op:h}).to({op:r},a).easing(p.Easing.Linear.None).onUpdate(function(){s.geometry.attributes.customSize.array[c]=this.op;s.geometry.attributes.customSize.needsUpdate=true}).repeat(n).yoyo(true).onComplete(function(){}).start()}break}}break}}}}}function I(e,t){var e=e!==undefined?e:undefined;if(e===undefined){return console.warn("flashEffect is not found nodeId")}var t=t!==undefined?t:{};var r=t.opacity!==undefined?t.opacity:0;var n=t.repeat!==undefined?t.repeat:0;var a=t.during!==undefined?t.during:500;if(e==="node_all"){for(var o in u){if(o!=="line"){u[o].material.uniforms.opacity.value=r}}}else{for(var i=0;i<f.children.length;i++){if(f.children[i]instanceof THREE.Points){if(f.children[i].topoType==l[e].topoType){var s=f.children[i];for(var d=0,v=s.geometry.idsList.length;d<v;d++){if(s.geometry.idsList[d]==e){var c=d;var h=s.geometry.attributes.customOpacity.array[c];if(n>100){new p.Tween({op:h}).to({op:r},a).easing(p.Easing.Linear.None).onUpdate(function(){s.geometry.attributes.customOpacity.array[c]=this.op;s.geometry.attributes.customOpacity.needsUpdate=true}).repeat(Infinity).yoyo(true).onComplete(function(){}).start()}else{new p.Tween({op:h}).to({op:r},a).easing(p.Easing.Linear.None).onUpdate(function(){s.geometry.attributes.customOpacity.array[c]=this.op;s.geometry.attributes.customOpacity.needsUpdate=true}).repeat(n).yoyo(true).onComplete(function(){}).start()}break}}break}}}}}function D(e,t){var e=e!==undefined?e:undefined;if(e===undefined){return console.warn("flickerEffect is not found nodeId")}var t=t!==undefined?t:{};var r=t.color!==undefined?t.color:16711680;var n=t.repeat!==undefined?t.repeat:3;var a=t.during!==undefined?t.during:500;var o=new THREE.Color(r);var i=o.r,s=o.g,d=o.b;var u;for(var v=0;v<f.children.length;v++){if(f.children[v]instanceof THREE.Points){if(f.children[v].topoType==l[e].topoType){var c=f.children[v];for(var h=0,m=c.geometry.idsList.length;h<m;h++){if(c.geometry.idsList[h]==e){var g=h;var y=c.geometry.attributes.customColor.array[g*3];var E=c.geometry.attributes.customColor.array[g*3+1];var w=c.geometry.attributes.customColor.array[g*3+2];if(n>=100){u=new p.Tween({r:y,g:E,b:w}).to({r:i,g:s,b:d},a).easing(p.Easing.Linear.None).onUpdate(function(){c.geometry.attributes.customColor.array[g*3]=this.r;c.geometry.attributes.customColor.array[g*3+1]=this.g;c.geometry.attributes.customColor.array[g*3+2]=this.b;c.geometry.attributes.customColor.needsUpdate=true}).repeat(Infinity).yoyo(true).onComplete(function(){}).start()}else{u=new p.Tween({r:y,g:E,b:w}).to({r:i,g:s,b:d},a).easing(p.Easing.Linear.None).onUpdate(function(){c.geometry.attributes.customColor.array[g*3]=this.r;c.geometry.attributes.customColor.array[g*3+1]=this.g;c.geometry.attributes.customColor.array[g*3+2]=this.b;c.geometry.attributes.customColor.needsUpdate=true}).repeat(n).yoyo(true).onComplete(function(){c.geometry.attributes.customColor.array[g*3]=i;c.geometry.attributes.customColor.array[g*3+1]=s;c.geometry.attributes.customColor.array[g*3+2]=d;c.geometry.attributes.customColor.needsUpdate=true;p.remove(this)}).start()}break}}break}}}var r=new Object;r.set=function(e){c.geometry.attributes.customColor.array[g*3]=e.r;c.geometry.attributes.customColor.array[g*3+1]=e.g;c.geometry.attributes.customColor.array[g*3+2]=e.b};r.tween=u;return r}function j(e){var e=e!==undefined?e:{};var t=e.map!==undefined?e.map:undefined;if(t===undefined){return console.warn("similarGifEffect is not found map")}var r=e.tilesHoriz!==undefined?e.tilesHoriz:1;var n=e.tilesVert!==undefined?e.tilesVert:1;var a=e.numTiles!==undefined?e.numTiles:r*n;var o=e.duration!==undefined?e.duration:100;var i=e.size!==undefined?e.size:1;var s=g[t];var d=h.loadPicture(s);var l=new THREE.Sprite(new THREE.SpriteMaterial({map:d,side:THREE.DoubleSide}));l.scale.set(i,i,1);l.cartoon=new B(d,r,n,a,o);return l}function B(e,t,r,n,a){this.tilesHoriz=t;this.tilesVert=r;this.numTiles=n;e.wrapS=e.wrapT=THREE.RepeatWrapping;e.repeat.set(1/this.tilesHoriz,1/this.tilesVert);this.duration=a;this.currentDisplayTime=0;this.currentTile=0;this.update=function(t){this.currentDisplayTime+=t;while(this.currentDisplayTime>this.duration){this.currentDisplayTime-=this.duration;this.currentTile++;if(this.currentTile==this.numberOfTiles)this.currentTile=0;var r=this.currentTile%this.tilesHoriz;e.offset.x=r/this.tilesHoriz;var n=this.tilesVert-1-Math.floor(this.currentTile/this.tilesHoriz);e.offset.y=n/this.tilesVert}}}function _(e){var e=e!==undefined?e:{};var t=e.topColor!==undefined?e.topColor:65535;var r=e.bottomColor!==undefined?e.bottomColor:0;var n=new THREE.CylinderGeometry(80,80,50,20,1,false);var a=C["protectedEffect"];var o=new THREE.ShaderMaterial({fragmentShader:a.fragmentShader,vertexShader:a.vertexShader,uniforms:{topColor:{type:"c",value:new THREE.Color(t)},bottomColor:{type:"c",value:new THREE.Color(r)},offset:{type:"f",value:40},exponent:{type:"f",value:.1}},transparent:true,blending:THREE.AdditiveBlending,polygonOffset:true,polygonOffsetFactor:.2,polygonOffsetUnits:.2,alphaTest:.2,depthWrite:false,opacity:1});var i=new THREE.Mesh(n,o);return i}function G(e){var e=e!==undefined?e:{};var t=e.cylinderColor!==undefined?e.cylinderColor:"rgb(204, 192, 204)";var n=e.horizontalLineColor!==undefined?e.horizontalLineColor:"rgba(240, 139, 252, 1)";var i=e.horizontalLightfromColor!==undefined?e.horizontalLightfromColor:"rgba(167, 45, 202, 0.5)";var s=e.horizontalLighttoColor!==undefined?e.horizontalLighttoColor:"rgba(92, 34, 140, 0.5)";var d=e.sphereInnerColor!==undefined?e.sphereInnerColor:"rgba(255, 255, 255, 1)";var l=e.verticalInnerlightColor!==undefined?e.verticalInnerlightColor:"rgba(92, 34, 140, 1)";var u=e.outterLightColor!==undefined?e.outterLightColor:"rgba(240, 139, 252, 0.5)";var f=new THREE.Object3D;var v=new THREE.Mesh(new THREE.PlaneGeometry(200,200),new THREE.MeshBasicMaterial({side:THREE.DoubleSide,map:a(i,n,s),transparent:true,color:16777215,blending:THREE.AdditiveBlending,depthTest:false}));f.add(v);v.rotateX(Math.PI/2);var c=30;var p=new THREE.Object3D;for(var h=0;h<360;h+=45){var m=new THREE.Sprite(new THREE.SpriteMaterial({map:o(d,u),transparent:true,blending:THREE.AdditiveBlending,depthTest:false}));m.position.set(c*Math.cos(h*Math.PI/180),0,c*Math.sin(h*Math.PI/180));m.scale.set(5,5,5);p.add(m)}for(var h=15;h<360;h+=45){var m=new THREE.Sprite(new THREE.SpriteMaterial({map:o(d,u),transparent:true,blending:THREE.AdditiveBlending,depthTest:false}));m.position.set(c*Math.cos(h*Math.PI/180),0,c*Math.sin(h*Math.PI/180));m.scale.set(8,8,8);p.add(m)}f.add(p);var g=new THREE.Sprite(new THREE.SpriteMaterial({map:r(l,u),transparent:true,blending:THREE.AdditiveBlending,depthTest:false}));g.scale.set(260,150,150);f.add(g);var y=new THREE.Mesh(new THREE.CylinderGeometry(10,10,3,15),new THREE.MeshBasicMaterial({color:new THREE.Color(t)}));f.add(y);return f}function k(e){var e=e!==undefined?e:{};var t=e.cylinderColor!==undefined?e.cylinderColor:"rgb(183, 205, 205)";var a=e.outterLightColor!==undefined?e.outterLightColor:"rgba(100, 100, 100, 0.5)";var o=e.horizontalLineColor!==undefined?e.horizontalLineColor:"rgba(195, 195, 195, 1)";var i=e.innerLightColor!==undefined?e.innerLightColor:"rgba(195, 195, 195, 1)";var s=new THREE.Object3D;var d=new THREE.Mesh(new THREE.CylinderGeometry(30,30,10,25),new THREE.MeshBasicMaterial({color:new THREE.Color(t)}));s.add(d);var l=new THREE.Mesh(new THREE.PlaneGeometry(250,250),new THREE.MeshBasicMaterial({side:THREE.DoubleSide,map:n(a,o,a),transparent:true,color:16777215,blending:THREE.AdditiveBlending,depthTest:false,depthWrite:false}));l.rotateX(Math.PI/2);s.add(l);var u=new THREE.Sprite(new THREE.SpriteMaterial({map:r(i,a),transparent:true,blending:THREE.AdditiveBlending,depthTest:false,depthWrite:false}));u.scale.set(350,250,250);s.add(u);return s}function F(e){var e=e!==undefined?e:{};var r=e.color!==undefined?e.color:"rgba(0, 255, 255, 1)";var n=new THREE.Object3D;var a=new THREE.Mesh(new THREE.PlaneGeometry(100,100),new THREE.MeshBasicMaterial({map:t(r),transparent:true,side:THREE.DoubleSide,depthTest:false,depthWrite:false,blending:THREE.AdditiveBlending}));a.rotateX(Math.PI/2);n.add(a);for(var o=0;o<1;o++){var i=a.clone();i.position.y=-1*(o+2);n.add(i)}return n}}function t(e){var t=document.createElement("canvas");t.width=256;t.height=256;var r=t.getContext("2d");var n=r.createRadialGradient(t.width/2,t.height/2,0,t.width/2,t.height/2,t.width/2);n.addColorStop(0,"rgba(0,0,0,0)");n.addColorStop(.5,"rgba(0,0,0,0)");n.addColorStop(.99,e);n.addColorStop(1,"rgba(0, 0, 0, 0)");r.fillStyle=n;r.fillRect(0,0,t.width,t.height);var a=new THREE.Texture(t);a.needsUpdate=true;return a}function r(e,t){var r=document.createElement("canvas");r.width=512;r.height=512;var n=r.getContext("2d");var a=n.createRadialGradient(r.width/2,r.height/2,0,r.width/2,r.height/2,r.width/2);a.addColorStop(0,e);a.addColorStop(.2,t);a.addColorStop(1,"rgba(0, 0,0, 0)");n.fillStyle=a;n.fillRect(0,0,r.width,r.height);var o=new THREE.Texture(r);o.needsUpdate=true;return o}function n(e,t,r){var n=document.createElement("canvas");n.width=512;n.height=512;var a=n.getContext("2d");var o=a.createRadialGradient(n.width/2,n.height/2,0,n.width/2,n.height/2,n.width/2);o.addColorStop(0,"rgba(0, 0, 0, 0)");o.addColorStop(.36,e);o.addColorStop(.38,t);o.addColorStop(.39,t);o.addColorStop(.4,r);o.addColorStop(1,"rgba(0, 0,0, 0)");a.fillStyle=o;a.fillRect(0,0,n.width,n.height);var i=new THREE.Texture(n);i.needsUpdate=true;return i}function a(e,t,r){var n=document.createElement("canvas");n.width=512;n.height=512;var a=n.getContext("2d");var o=a.createRadialGradient(n.width/2,n.height/2,0,n.width/2,n.height/2,n.width/2);o.addColorStop(0,"rgba(0, 0, 0, 0)");o.addColorStop(.17,e);o.addColorStop(.18,t);o.addColorStop(.19,t);o.addColorStop(.2,e);o.addColorStop(.28,r);o.addColorStop(.29,t);o.addColorStop(.3,t);o.addColorStop(.31,e);o.addColorStop(.42,r);o.addColorStop(.43,t);o.addColorStop(.44,t);o.addColorStop(.45,r);o.addColorStop(1,"rgba(0, 0,0, 0)");a.fillStyle=o;a.fillRect(0,0,n.width,n.height);var i=new THREE.Texture(n);i.needsUpdate=true;return i}function o(e,t){var r=document.createElement("canvas");r.width=512;r.height=512;var n=r.getContext("2d");var a=n.createRadialGradient(r.width/2,r.height/2,0,r.width/2,r.height/2,r.width/2);a.addColorStop(0,e);a.addColorStop(.5,t);a.addColorStop(1,"rgba(0, 0,0, 0)");n.fillStyle=a;n.fillRect(0,0,r.width,r.height);var o=new THREE.Texture(r);o.needsUpdate=true;return o}return e});